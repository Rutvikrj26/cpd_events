============================= test session starts ==============================
platform darwin -- Python 3.13.4, pytest-8.4.2, pluggy-1.6.0
django: version: 6.0, settings: config.settings.development (from env)
rootdir: /Users/rutvikrj26/Desktop/cpd_events/backend
configfile: pyproject.toml
plugins: cov-4.1.0, django-4.11.1, Faker-22.7.0
collected 4 items

src/organizations/tests/test_plans_and_billing.py .F..                   [100%]

=================================== FAILURES ===================================
__________ TestOrganizationPlansAndBilling.test_upgrade_subscription ___________

self = <organizations.tests.test_plans_and_billing.TestOrganizationPlansAndBilling object at 0x11066d1d0>
mock_stripe = <MagicMock name='stripe_service' id='4596661760'>
organizer_client = <rest_framework.test.APIClient object at 0x11200ac10>
organization = <Organization: Test Org>

    @patch('organizations.views.stripe_service')
    def test_upgrade_subscription(self, mock_stripe, organizer_client, organization):
        mock_stripe.create_checkout_session.return_value = {'success': True, 'url': 'https://stripe.com/checkout'}
    
        url = f'/api/v1/organizations/{organization.uuid}/subscription/upgrade/'
        data = {'plan': 'team'}
    
    
        response = organizer_client.post(url, data)
>       assert response.status_code == 200
E       assert 400 == 200
E        +  where 400 = <Response status_code=400, "application/json">.status_code

src/organizations/tests/test_plans_and_billing.py:67: AssertionError
----------------------------- Captured stderr call -----------------------------
Bad Request: /api/v1/organizations/13ad97ba-24ea-4cdd-8c15-95452d50105a/subscription/upgrade/
------------------------------ Captured log call -------------------------------
WARNING  django.request:log.py:249 Bad Request: /api/v1/organizations/13ad97ba-24ea-4cdd-8c15-95452d50105a/subscription/upgrade/
=============================== warnings summary ===============================
src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_get_plans
src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_upgrade_subscription
src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_invite_organizer_external
src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_invite_organizer_non_existent
  /Users/rutvikrj26/Desktop/cpd_events/backend/.venv/lib/python3.13/site-packages/django/core/handlers/base.py:62: UserWarning: No directory at: /Users/rutvikrj26/Desktop/cpd_events/backend/src/staticfiles/
    mw_instance = middleware(adapted_handler)

src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_get_plans
  /Users/rutvikrj26/Desktop/cpd_events/backend/.venv/lib/python3.13/site-packages/drf_yasg/views.py:100: DeprecationWarning: SwaggerJSONRenderer & SwaggerYAMLRenderer's `format` has changed to not include a `.` prefix, please silence this warning by setting `SWAGGER_USE_COMPAT_RENDERERS = False` in your Django settings and ensure your application works (check your URLCONF and swagger/redoc URLs).
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED src/organizations/tests/test_plans_and_billing.py::TestOrganizationPlansAndBilling::test_upgrade_subscription
=================== 1 failed, 3 passed, 5 warnings in 10.85s ===================
